function jstat(){}j=jstat;
(function(){var a=false,b=/xyz/.test(function(){})?/\b_super\b/:/.*/;this.Class=function(){};Class.extend=function(c){function d(){!a&&this.init&&this.init.apply(this,arguments)}var e=this.prototype;a=true;var f=new this;a=false;for(var g in c)f[g]=typeof c[g]=="function"&&typeof e[g]=="function"&&b.test(c[g])?function(i,h){return function(){var k=this._super;this._super=e[i];var l=h.apply(this,arguments);this._super=k;return l}}(g,c[g]):c[g];d.prototype=f;d.constructor=d;d.extend=arguments.callee;
return d}})();jstat.ONE_SQRT_2PI=0.3989422804014327;jstat.LN_SQRT_2PI=0.9189385332046728;jstat.LN_SQRT_PId2=0.22579135264472744;jstat.DBL_MIN=2.22507E-308;jstat.DBL_EPSILON=1.0E-9;jstat.SQRT_32=5.656854249492381;jstat.TWO_PI=6.283185307179586;jstat.DBL_MIN_EXP=-745;jstat.SQRT_2dPI=0.79788456080287;jstat.LN_SQRT_PI=0.5723649429247;jstat.seq=function(a,b,c){return(new Range(a,b,c)).getPoints()};
jstat.dnorm=function(a,b,c,d){if(b==null)b=0;if(c==null)c=1;if(d==null)d=false;b=new NormalDistribution(b,c);if(isNaN(a))if(a.length){c=[];for(var e=0;e<a.length;e++)c.push(b._pdf(a[e],d));return c}else throw"Illegal argument: x";else return b._pdf(a,d)};
jstat.pnorm=function(a,b,c,d,e){if(b==null)b=0;if(c==null)c=1;if(d==null)d=true;if(e==null)e=false;b=new NormalDistribution(b,c);if(isNaN(a))if(a.length){c=[];for(var f=0;f<a.length;f++)c.push(b._cdf(a[f],d,e));return c}else throw"Illegal argument: x";else return b._cdf(a,d,e)};
jstat.dlnorm=function(a,b,c,d){if(b==null)b=0;if(c==null)c=1;if(d==null)d=false;b=new LogNormalDistribution(b,c);if(isNaN(a))if(a.length){c=[];for(var e=0;e<a.length;e++)c.push(b._pdf(a[e],d));return c}else throw"Illegal argument: x";else return b._pdf(a,d)};
jstat.plnorm=function(a,b,c,d,e){if(b==null)b=0;if(c==null)c=1;if(d==null)d=true;if(e==null)e=false;b=new LogNormalDistribution(b,c);if(isNaN(a))if(a.length){c=[];for(var f=0;f<a.length;f++)c.push(b._cdf(a[f],d,e));return c}else throw"Illegal argument: x";else return b._cdf(a,d,e)};jstat.dbeta=function(a,b,c,d,e){if(e==null)e=false;b=new BetaDistribution(b,c);if(isNaN(a))if(a.length){c=[];for(d=0;d<a.length;d++)c.push(b._pdf(a[d],e));return c}else throw"Illegal argument: x";else return b._pdf(a,e)};
jstat.pbeta=function(a,b,c,d,e,f){if(f==null)f=false;if(e==null)e=true;b=new BetaDistribution(b,c);if(isNaN(a))if(a.length){c=[];for(d=0;d<a.length;d++)c.push(b._cdf(a[d],e,f));return c}else throw"Illegal argument: x";else return b._cdf(a,e,f)};jstat.dgamma=function(a,b,c,d,e){if(c==null)c=1;if(d==null)d=1/c;if(e==null)e=false;b=new GammaDistribution(b,d);if(isNaN(a))if(a.length){c=[];for(d=0;d<a.length;d++)c.push(b._pdf(a[d],e));return c}else throw"Illegal argument: x";else return b._pdf(a,e)};
jstat.pgamma=function(a,b,c,d,e,f){if(c==null)c=1;if(d==null)d=1/c;if(e==null)e=true;if(f==null)f=false;b=new GammaDistribution(b,d);if(isNaN(a))if(a.length){c=[];for(d=0;d<a.length;d++)c.push(b._cdf(a[d],e,f));return c}else throw"Illegal argument: x";else return b._cdf(a,e,f)};jstat.dt=function(a,b,c,d){if(d==null)d=false;b=new StudentTDistribution(b,c);if(isNaN(a))if(a.length){c=[];for(var e=0;e<a.length;e++)c.push(b._pdf(a[e],d));return c}else throw"Illegal argument: x";else return b._pdf(a,d)};
jstat.pt=function(a,b,c,d,e){if(d==null)d=true;if(e==null)e=false;b=new StudentTDistribution(b,c);if(isNaN(a))if(a.length){c=[];for(var f=0;f<a.length;f++)c.push(b._cdf(a[f],d,e));return c}else throw"Illegal argument: x";else return b._cdf(a,d,e)};
jstat.plot=function(a,b,c){if(a==null)throw"x is undefined in jstat.plot";if(b==null)throw"y is undefined in jstat.plot";if(a.length!=b.length)throw"x and y lengths differ in jstat.plot";var d={series:{lines:{},points:{}}},e=[];if(a.length==undefined){e.push([a,b]);d.series.points.show=true}else for(var f=0;f<a.length;f++)e.push([a[f],b[f]]);a="jstat graph";if(c!=null){if(c.type!=null)if(c.type=="l")d.series.lines.show=true;else if(c.type=="p"){d.series.lines.show=false;d.series.points.show=true}if(c.main!=
null)a=c.main}c=new Date;var g=c.getMilliseconds()*c.getMinutes()+c.getSeconds();$("body").append('<div title="'+a+'" style="display: none;" id="'+g+'"><div id="graph-'+g+'" style="width:95%; height: 95%"></div></div>');$("#"+g).dialog({modal:false,width:475,height:475,resizable:true,resize:function(){$.plot($("#graph-"+g),[e],d)},open:function(){$.plot($("#graph-"+g),[e],d)}})};jstat.trunc=function(a){return a>0?Math.floor(a):Math.ceil(a)};
jstat.isFinite=function(a){return!isNaN(a)&&a!=Number.POSITIVE_INFINITY&&a!=Number.NEGATIVE_INFINITY};
jstat.dopois_raw=function(a,b,c){if(b==0){if(a==0)return c?0:1;return c?Number.NEGATIVE_INFINITY:0}if(!jstat.isFinite(b))return c?Number.NEGATIVE_INFINITY:0;if(a<0)return c?Number.NEGATIVE_INFINITY:0;if(a<=b*jstat.DBL_MIN)return c?-b:Math.exp(-b);if(b<a*jstat.DBL_MIN){var d=-b+a*Math.log(b)-jstat.lgamma(a+1);return c?d:Math.exp(d)}d=jstat.TWO_PI*a;a=-jstat.stirlerr(a)-jstat.bd0(a,b);return c?-0.5*Math.log(d)+a:Math.exp(a)/Math.sqrt(d)};
jstat.bd0=function(a,b){var c,d,e,f,g;if(!jstat.isFinite(a)||!jstat.isFinite(b)||b==0)throw"illegal parameter in jstat.bd0";if(Math.abs(a-b)>0.1*(a+b)){f=(a-b)/(a+b);d=(a-b)*f;c=2*a*f;f*=f;for(g=1;;g++){c*=f;e=d+c/((g<<1)+1);if(e==d)return e;d=e}}return a*Math.log(a/b)+b-a};
jstat.stirlerr=function(a){var b=[0,0.15342640972002736,0.08106146679532726,0.05481412105191765,0.0413406959554093,0.03316287351993629,0.02767792568499834,0.023746163656297496,0.020790672103765093,0.018488450532673187,0.016644691189821193,0.015134973221917378,0.013876128823070748,0.012810465242920227,0.01189670994589177,0.011104559758206917,0.010411265261972096,0.009799416126158804,0.009255462182712733,0.008768700134139386,0.00833056343336287,0.00793411456431402,0.007573675487951841,0.007244554301320383,
0.00694284010720953,0.006665247032707682,0.006408994188004207,0.006171712263039458,0.0059513701127588475,0.0057462165130101155,0.005554733551962801],c;if(a<=15){c=a+a;if(c==parseInt(c))return b[parseInt(c)];return jstat.lgamma(a+1)-(a+0.5)*Math.log(a)+a-jstat.LN_SQRT_2PI}c=a*a;if(a>500)return(0.08333333333333333-0.002777777777777778/c)/a;if(a>80)return(0.08333333333333333-(0.002777777777777778-7.936507936507937E-4/c)/c)/a;if(a>35)return(0.08333333333333333-(0.002777777777777778-(7.936507936507937E-4-
5.952380952380953E-4/c)/c)/c)/a;return(0.08333333333333333-(0.002777777777777778-(7.936507936507937E-4-(5.952380952380953E-4-8.417508417508417E-4/c)/c)/c)/c)/a};
jstat.lgamma=function(a){return function(b){var c,d;if(isNaN(b))return b;if(b<=0&&b==jstat.trunc(b)){console.warn("Negative integer argument in lgammafn_sign");return Number.POSITIVE_INFINITY}c=Math.abs(b);if(c<=10)return Math.log(Math.abs(jstat.gamma(b)));if(c>2.5327372760800758E305){console.warn("Illegal arguement passed to lgammafn_sign");return Number.POSITIVE_INFINITY}if(b>0)return b>1E17?b*(Math.log(b)-1):b>4934720?jstat.LN_SQRT_2PI+(b-0.5)*Math.log(b)-b:jstat.LN_SQRT_2PI+(b-0.5)*Math.log(b)-
b+jstat.lgammacor(b);d=Math.abs(Math.sin(Math.PI*c));if(d==0)throw"Should never happen!!";c=jstat.LN_SQRT_PId2+(b-0.5)*Math.log(c)-b-Math.log(d)-jstat.lgammacor(c);if(Math.abs((b-jstat.trunc(b-0.5))*c/b)<1.4901161193847656E-8)throw"The answer is less than half the precision argument too close to a negative integer";return c}(a,null)};
jstat.gamma=function(a){var b=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],c=[-30.840230011973897,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.25967555349],d=[-0.001910444077728,8.4171387781295E-4,-5.952379913043012E-4,7.936507935003503E-4,-0.0027777777777776816,0.08333333333333333,0.0057083835261],e,f,g,i,h,k,l;f=0;
g=1;e=0;h=a;if(h<=0){h=-a;l=jstat.trunc(h);i=h-l;if(i!=0){if(l!=jstat.trunc(l*0.5)*2)f=1;g=-Math.PI/Math.sin(Math.PI*i);h+=1}else return Number.POSITIVE_INFINITY}if(h<jstat.DBL_EPSILON)if(h>=jstat.DBL_MIN)i=1/h;else return Number.POSITIVE_INFINITY;else if(h<12){l=h;if(h<1){k=h;h+=1}else{e=parseInt(h)-1;h-=parseFloat(e);k=h-1}i=0;d=1;for(a=0;a<8;++a){i=(i+b[a])*k;d=d*k+c[a]}i=i/d+1;if(l<h)i/=l;else if(l>h)for(a=0;a<e;++a){i*=h;h+=1}}else if(h<=171.624){c=h*h;b=d[6];for(a=0;a<6;++a)b=b/c+d[a];b=b/h-
h+jstat.LN_SQRT_2PI;b+=(h-0.5)*Math.log(h);i=Math.exp(b)}else return Number.POSITIVE_INFINITY;if(f)i=-i;if(g!=1)i=g/i;return i};
jstat.lgammacor=function(a){var b=[+0.16663894804518634,-1.384948176067564E-5,+9.81082564692473E-9,-1.809129475572494E-11,+6.221098041892606E-14,-3.399615005417722E-16,+2.683181998482699E-18,-2.868042435334643E-20,+3.9628370610464347E-22,-6.831888753985767E-24,+1.4292273559424982E-25,-3.5475981581010704E-27,+1.025680058010471E-28,-3.401102254316749E-30,+1.276642195630063E-31],c;if(a<10)return Number.NaN;else if(a>=3.745194030963158E306)throw"Underflow error in lgammacor";else if(a<9.490626562425156E7){c=
10/a;return jstat.chebyshev(c*c*2-1,b,5)/a}return 1/(a*12)};
jstat.incompleteBeta=function(a,b,c){function d(f,g,i){var h,k,l,n,m,o,p,s,r;p=f+g;r=f+1;s=f-1;n=1;m=1-p*i/r;if(Math.abs(m)<1.0E-30)m=1.0E-30;o=m=1/m;for(h=1;h<=100;h++){k=2*h;l=h*(g-h)*i/((s+k)*(f+k));m=1+l*m;if(Math.abs(m)<1.0E-30)m=1.0E-30;n=1+l/n;if(Math.abs(n)<1.0E-30)n=1.0E-30;m=1/m;o*=m*n;l=-(f+h)*(p+h)*i/((f+k)*(r+k));m=1+l*m;if(Math.abs(m)<1.0E-30)m=1.0E-30;n=1+l/n;if(Math.abs(n)<1.0E-30)n=1.0E-30;m=1/m;k=m*n;o*=k;if(Math.abs(k-1)<3.0E-7)break}if(h>100)throw"a or b too big, or MAXIT too small in betacf";
return o}var e;if(c<0||c>1)throw"bad x in routine incompleteBeta";e=c==0||c==1?0:Math.exp(jstat.lgamma(a+b)-jstat.lgamma(a)-jstat.lgamma(b)+a*Math.log(c)+b*Math.log(1-c));return c<(a+1)/(a+b+2)?e*d(a,b,c)/a:1-e*d(b,a,1-c)/b};jstat.chebyshev=function(a,b,c){var d,e,f,g;if(c<1||c>1E3)return Number.NaN;if(a<-1.1||a>1.1)return Number.NaN;f=a*2;a=e=d=0;for(g=1;g<=c;g++){e=d;d=a;a=f*d-e+b[c-g]}return(a-e)*0.5};jstat.fmin2=function(a,b){return a<b?a:b};
jstat.log1p=function(a){var b=0;if(a<=-1)return Number.NEGATIVE_INFINITY;if(a<0||a>1)return Math.log(1+a);for(var c=1;c<50;c++)if(c%2===0)b-=Math.pow(a,c)/c;else b+=Math.pow(a,c)/c;return b};jstat.expm1=function(a){var b;b=Math.abs(a);if(b<jstat.DBL_EPSILON)return a;if(b>0.697)return Math.exp(a)-1;b=b>1.0E-8?Math.exp(a)-1:(a/2+1)*a;b-=(1+b)*(jstat.log1p(b)-a);return b};
jstat.logBeta=function(a,b){var c,d,e;d=e=a;if(b<d)d=b;if(b>e)e=b;if(d<0){console.warn("Both arguements must be >= 0");return Number.NaN}else if(d==0)return Number.POSITIVE_INFINITY;else if(!jstat.isFinite(e))return Number.NEGATIVE_INFINITY;if(d>=10){c=jstat.lgammacor(d)+jstat.lgammacor(e)-jstat.lgammacor(d+e);return Math.log(e)*-0.5+jstat.LN_SQRT_2PI+c+(d-0.5)*Math.log(d/(d+e))+e*jstat.log1p(-d/(d+e))}else if(e>=10){c=jstat.lgammacor(e)-jstat.lgammacor(d+e);return jstat.lgamma(d)+c+d-d*Math.log(d+
e)+(e-0.5)*jstat.log1p(-d/(d+e))}else return Math.log(jstat.gamma(d)*(jstat.gamma(e)/jstat.gamma(d+e)))};
jstat.dbinom_raw=function(a,b,c,d,e){if(e==null)e=false;if(c==0)return a==0?e?0:1:e?Number.NEGATIVE_INFINITY:0;if(d==0)return a==b?e?0:1:e?Number.NEGATIVE_INFINITY:0;if(a==0){if(b==0)return e?0:1;c=c<0.1?-jstat.bd0(b,b*d)-b*c:b*Math.log(d);return e?c:Math.exp(c)}if(a==b){c=d<0.1?-jstat.bd0(b,b*c)-b*d:b*Math.log(c);return e?c:Math.exp(c)}if(a<0||a>b)return e?Number.NEGATIVE_INFINITY:0;c=jstat.stirlerr(b)-jstat.stirlerr(a)-jstat.stirlerr(b-a)-jstat.bd0(a,b*c)-jstat.bd0(b-a,b*d);a=Math.log(jstat.TWO_PI)+
Math.log(a)+jstat.log1p(-a/b);return e?c-0.5*a:Math.exp(c-0.5*a)};Range=Class.extend({init:function(a,b,c){this._minimum=parseFloat(a);this._maximum=parseFloat(b);this._numPoints=parseFloat(c)},getMinimum:function(){return this._minimum},getMaximum:function(){return this._maximum},getNumPoints:function(){return this._numPoints},getPoints:function(){for(var a=[],b=this._minimum,c=(this._maximum-this._minimum)/(this._numPoints-1),d=0;d<this._numPoints;d++){a[d]=parseFloat(b.toFixed(4));b+=c}return a}});
Range.validate=function(a){if(!a instanceof Range)return false;if(isNaN(a.getMinimum())||isNaN(a.getMaximum())||isNaN(a.getNumPoints())||a.getMaximum()<a.getMinimum()||a.getNumPoints()<=0)return false;return true};
var ContinuousDistribution=Class.extend({init:function(a){this._name=a},getName:function(){return this._name},getClassName:function(){return this._name+"Distribution"},density:function(a){if(isNaN(a))if(Range.validate(a)){for(var b=(a.getMaximum()-a.getMinimum())/a.getNumPoints(),c=a.getMinimum(),d=[],e=0;e<a.getNumPoints();e++){d[e]=this._pdf(c).toFixed(15);c+=b}return d}else throw"Invalid parameter supplied to "+this.getClassName()+".density()";else return this._pdf(a).toFixed(15)},cumulativeDensity:function(a){if(isNaN(a))if(Range.validate(a)){for(var b=
(a.getMaximum()-a.getMinimum())/a.getNumPoints(),c=a.getMinimum(),d=[],e=0;e<a.getNumPoints();e++){d[e]=this._cdf(c).toFixed(15);c+=b}return d}else throw"Invalid parameter supplied to "+this.getClassName()+".cumulativeDensity()";else return this._cdf(a).toFixed(15)},getRange:function(a,b){if(a==null)a=5;if(b==null)b=500;var c=this.getMean()-a*Math.sqrt(this.getVariance()),d=this.getMean()+a*Math.sqrt(this.getVariance());if(this.getClassName()=="GammaDistribution"||this.getClassName()=="Log-normalDistribution"){c=
0;d=this.getMean()+a*Math.sqrt(this.getVariance())}else if(this.getClassName()=="BetaDistribution"){c=0;d=1}return new Range(c,d,b)},getVariance:function(){},getMean:function(){},getQuantile:function(a){function b(e,f){for(var g=e.getPoints(),i=0,h=999,k=0;k<g.length;k++){var l=c.cumulativeDensity(g[k]);l=Math.abs(l-f);if(l<h){i=k;h=l}}if(h<=1.0E-6)return g[i];else{g=new Range(g[i-1],g[i+1],100);return b(g,f)}}var c=this,d=this.getRange(5,20);return b(d,a)}}),NormalDistribution=ContinuousDistribution.extend({init:function(a,
b){this._super("Normal");this._mean=a;this._sigma=b},_pdf:function(a,b){if(b==null)b=false;var c=this._sigma,d=this._mean;if(!jstat.isFinite(c))return b?Number.NEGATIVE_INFINITY:0;if(!jstat.isFinite(a)&&d==a)return Number.NaN;if(c<=0){if(c<0)throw"invalid sigma in _pdf";return a==d?Number.POSITIVE_INFINITY:b?Number.NEGATIVE_INFINITY:0}a=(a-d)/c;if(!jstat.isFinite(a))return b?Number.NEGATIVE_INFINITY:0;return b?-(jstat.LN_SQRT_2PI+0.5*a*a+Math.log(c)):jstat.ONE_SQRT_2PI*Math.exp(-0.5*a*a)/c},_cdf:function(a,
b,c){if(b==null)b=true;if(c==null)c=false;var d,e=this._mean;d=this._sigma;if(!jstat.isFinite(a)&&e==a)return Number.NaN;if(d<=0){if(d<0)throw"invalid sigma in _cdf";return a<e?b?c?Number.NEGATIVE_INFINITY:0:c?0:1:b?c?0:1:c?Number.NEGATIVE_INFINITY:0}d=(a-e)/d;if(!jstat.isFinite(d))return a<e?b?c?Number.NEGATIVE_INFINITY:0:c?0:1:b?c?0:1:c?Number.NEGATIVE_INFINITY:0;a=d;a=function(f,g,i,h,k){function l(z){q=(z*x>0?Math.floor(z*x):Math.ceil(z*x))/x;B=(z-q)*(z+q);if(k){g=-q*q*0.5+-B*0.5+Math.log(v);
if(y&&f>0||A&&f<=0)i=jstat.log1p(-Math.exp(-q*q*0.5)*Math.exp(-B*0.5)*v)}else{g=Math.exp(-q*q*0.5)*Math.exp(-B*0.5)*v;i=1-g}}var n=[2.2352520354606837,161.02823106855587,1067.6894854603709,18154.98125334356,0.06568233791820745],m=[47.202581904688245,976.0985517377767,10260.932208618979,45507.78933502673],o=[0.39894151208813466,8.883149794388377,93.50665613217785,597.2702763948002,2494.5375852903726,6848.190450536283,11602.65143764735,9842.714838383978,1.0765576773720192E-8],p=[22.266688044328117,
235.387901782625,1519.3775994075547,6485.558298266761,18615.571640885097,34900.95272114598,38912.00328609327,19685.429676859992],s=[0.215898534057957,0.12740116116024736,0.022235277870649807,0.0014216191932278934,2.9112874951168793E-5,0.023073441764940174],r=[1.284260096144911,0.4682382124808651,0.06598813786892856,0.0037823963320275824,7.297515550839662E-5],x=16,t,w,v,B,q,u,y,A,C=jstat.DBL_MIN;t=jstat.DBL_EPSILON*0.5;y=h!=1;A=h!=0;h=Math.abs(f);if(h<=0.67448975){if(h>t){q=f*f;w=n[4]*q;t=q;for(u=
0;u<3;++u){w=(w+n[u])*q;t=(t+m[u])*q}}else w=t=0;v=f*(w+n[3])/(t+m[3]);if(y)g=0.5+v;if(A)i=0.5-v;if(k){if(y)g=Math.log(g);if(A)i=Math.log(i)}}else if(h<=jstat.SQRT_32){w=o[8]*h;t=h;for(u=0;u<7;++u){w=(w+o[u])*h;t=(t+p[u])*h}v=(w+o[7])/(t+p[7]);l(h);if(f>0){v=g;if(y){g=i;i=v}}}else if(k&&h<1.0E170||y&&-37.5193<f&&f<8.2924||A&&-8.2924<f&&f<37.5193){q=1/(f*f);w=s[5]*q;t=q;for(u=0;u<4;++u){w=(w+s[u])*q;t=(t+r[u])*q}v=q*(w+s[4])/(t+r[4]);v=(jstat.ONE_SQRT_2PI-v)/h;l(f);if(f>0){v=g;if(y){g=i;i=v}}}else if(f>
0){g=k?0:1;i=k?Number.NEGATIVE_INFINITY:0}else{g=k?Number.NEGATIVE_INFINITY:0;i=k?0:1}if(k){if(g>-C)g=0;if(i>-C)i=0}else{if(g<C)g=0;if(i<C)i=0}return[g,i]}(a,d,void 0,b?0:1,c);return b?a[0]:a[1]},getMean:function(){return this._mean},getSigma:function(){return this._sigma},getVariance:function(){return this._sigma*this._sigma}}),LogNormalDistribution=ContinuousDistribution.extend({init:function(a,b){this._super("Log-normal");this._location=a;this._scale=b},_pdf:function(a,b){var c,d=this._scale;c=
this._location;if(b==null)b=false;if(d<=0)throw"Illegal parameter in _pdf";if(a<=0)return b?Number.NEGATIVE_INFINITY:0;c=(Math.log(a)-c)/d;return b?-(jstat.LN_SQRT_2PI+0.5*c*c+Math.log(a*d)):jstat.ONE_SQRT_2PI*Math.exp(-0.5*c*c)/(a*d)},_cdf:function(a,b,c){var d=this._scale,e=this._location;if(b==null)b=true;if(c==null)c=false;if(d<=0)throw"illegal std in _cdf";if(a>0)return(new NormalDistribution(e,d))._cdf(Math.log(a),b,c);return b?c?Number.NEGATIVE_INFINITY:0:c?0:1},getLocation:function(){return this._location},
getScale:function(){return this._scale},getMean:function(){return Math.exp((this._location+this._scale)/2)},getVariance:function(){return(Math.exp(this._scale)-1)*Math.exp(2*this._location+this._scale)}}),GammaDistribution=ContinuousDistribution.extend({init:function(a,b){this._super("Gamma");this._shape=a;this._scale=b},_pdf:function(a,b){var c,d=this._shape,e=this._scale;if(b==null)b=false;if(d<0||e<=0)throw"Illegal argument in _pdf";if(a<0)return b?Number.NEGATIVE_INFINITY:0;if(d==0)return a==
0?Number.POSITIVE_INFINITY:b?Number.NEGATIVE_INFINITY:0;if(a==0){if(d<1)return Number.POSITIVE_INFINITY;if(d>1)return b?Number.NEGATIVE_INFINITY:0;return b?-Math.log(e):1/e}if(d<1){c=jstat.dpois_raw(d,a/e,b);return b?c+Math.log(d/a):c*d/a}c=jstat.dopois_raw(d-1,a/e,b);return b?c-Math.log(e):c/e},_cdf:function(a,b,c){function d(){g=Math.sqrt(e)*3*(Math.pow(a/e,1/3)+1/(9*e)-1);return(new NormalDistribution(0,1))._cdf(g,b,c)}if(b==null)b=true;if(c==null)c=false;var e=this._shape,f=this._scale,g,i,h,
k,l,n,m,o,p,s,r;if(e<=0||f<=0){console.warn("Invalid gamma params in _cdf");return Number.NaN}a/=f;if(isNaN(a))return a;if(a<=0)return b?c?Number.NEGATIVE_INFINITY:0:c?0:1;if(e>1E5)return d();if(a>1E8*e)return a>jstat.DBL_MAX*e?b?c?0:1:c?Number.NEGATIVE_INFINITY:0:d();if(a<=1||a<e){r=1;f=e*Math.log(a)-a-jstat.lgamma(e+1);p=h=1;m=e;do{m+=1;h*=a/m;p+=h}while(h>jstat.DBL_EPSILON*p)}else{r=0;f=e*Math.log(a)-a-jstat.lgamma(e);m=1-e;o=m+a+1;g=1;i=a;h=a+1;k=a*o;p=h/k;for(s=1;;s++){m+=1;o+=2;n=m*s;l=o*h-
n*g;n=o*k-n*i;if(Math.abs(n)>0){i=p;p=l/n;if(Math.abs(i-p)<=jstat.DBL_EPSILON*jstat.fmin2(1,p))break}g=h;i=k;h=l;k=n;if(Math.abs(l)>=1.0E37){g/=1.0E37;i/=1.0E37;h/=1.0E37;k/=1.0E37}}}f+=Math.log(p);b=b==r;if(c&&b)return f;return b?Math.exp(f):c?f>-Math.LN2?Math.log(-jstat.expm1(f)):jstat.log1p(-Math.exp(f)):-jstat.expm1(f)},getShape:function(){return this._shape},getScale:function(){return this._scale},getMean:function(){return this._shape*this._scale},getVariance:function(){return this._shape*Math.pow(this._scale,
2)}}),BetaDistribution=ContinuousDistribution.extend({init:function(a,b){this._super("Beta");this._alpha=a;this._beta=b},_pdf:function(a,b){if(b==null)b=false;var c=this._alpha,d=this._beta;if(c<=0||d<=0){console.warn("Illegal arguments in _pdf");return Number.NaN}if(a<0||a>1)return b?Number.NEGATIVE_INFINITY:0;if(a==0){if(c>1)return b?Number.NEGATIVE_INFINITY:0;if(c<1)return Number.POSITIVE_INFINITY;return b?Math.log(d):d}if(a==1){if(d>1)return b?Number.NEGATIVE_INFINITY:0;if(d<1)return Number.POSITIVE_INFINITY;
return b?Math.log(c):c}c=c<=2||d<=2?(c-1)*Math.log(a)+(d-1)*jstat.log1p(-a)-jstat.logBeta(c,d):Math.log(c+d-1)+jstat.dbinom_raw(c-1,c+d-2,a,1-a,true);return b?c:Math.exp(c)},_cdf:function(a,b,c){if(b==null)b=true;if(c==null)c=false;var d=this._alpha,e=this._beta;if(d<=0||e<=0){console.warn("Invalid argument in _cdf");return Number.NaN}if(a<=0)return b?c?Number.NEGATIVE_INFINITY:0:c?0.1:1;if(a>=1)return b?c?0.1:1:c?Number.NEGATIVE_INFINITY:0;return jstat.incompleteBeta(d,e,a)},getAlpha:function(){return this._alpha},
getBeta:function(){return this._beta},getMean:function(){return this._alpha/(this._alpha+this._beta)},getVariance:function(){return this._alpha*this._beta/(Math.pow(this._alpha+this._beta,2)*(this._alpha+this._beta+1))}}),StudentTDistribution=ContinuousDistribution.extend({init:function(a,b){this._super("StudentT");this._dof=a;this._mu=b},_pdf:function(a,b){if(b==null)b=false;return this._mu==null?this._dt(a,b):this._dnt(a,b)},_cdf:function(a,b,c){if(b==null)b=true;if(c==null)c=false;return this._mu==
null?this._pt(a,b,c):this._pnt(a,b,c)},_dt:function(a,b){var c,d,e=this._dof;if(e<=0){console.warn("Invalid parameters in _dt");return Number.NaN}if(!jstat.isFinite(a))return b?Number.NEGATIVE_INFINITY:0;if(!jstat.isFinite(e))return(new NormalDistribution(0,1)).density(a,b);c=-jstat.bd0(e/2,(e+1)/2)+jstat.stirlerr((e+1)/2)-jstat.stirlerr(e/2);d=a*a>0.2*e?Math.log(1+a*a/e)*e/2:-jstat.bd0(e/2,(e+a*a)/2)+a*a/2;e=jstat.TWO_PI*(1+a*a/e);c=c-d;return b?-0.5*Math.log(e)+c:Math.exp(c)/Math.sqrt(e)},_dnt:function(a,
b){if(b==null)b=false;var c=this._dof,d=this._mu;if(c<=0){console.warn("Illegal arguments _dnf");return Number.NaN}if(d==0)return this._dt(a,b);if(!jstat.isFinite(a))return b?Number.NEGATIVE_INFINITY:0;if(!isFinite(c)||c>1E8)return(new NormalDistribution(d,1)).density(a,b);if(Math.abs(a)>Math.sqrt(c*jstat.DBL_EPSILON)){d=new StudentTDistribution(c+2,d);c=Math.log(c)-Math.log(Math.abs(a))+Math.log(Math.abs(d._cdf(a*Math.sqrt((c+2)/c),true,false)-this._cdf(a,true,false)))}else c=jstat.lgamma((c+1)/
2)-jstat.lgamma(c/2)-0.5*(Math.log(Math.PI)+Math.log(c)+d*d);return b?c:Math.exp(c)},_pt:function(a,b,c){if(b==null)b=true;if(c==null)c=false;var d,e;d=this._dof;var f,g;if(b){f=c?Number.NEGATIVE_INFINITY:0;g=1}else if(c){f=0;g=Number.NEGATIVE_INFINITY}else{f=1;g=0}if(d<=0){console.warn("Invalid T distribution _pt");return Number.NaN}e=new NormalDistribution(0,1);if(!jstat.isFinite(a))return a<0?f:g;if(!jstat.isFinite(d))return e._cdf(a,b,c);if(d>4E5){d=1/(4*d);return e._cdf(a*(1-d)/sqrt(1+a*a*2*
d),b,c)}e=1+a/d*a;if(e>1.0E100){d=-0.5*d*(2*Math.log(Math.abs(a))-Math.log(d))-jstat.logBeta(0.5*d,0.5)-Math.log(0.5*d);d=c?d:Math.exp(d)}else if(d>a*a){b=new BetaDistribution(0.5,d/2);return b._cdf(a*a/(d+a*a),false,c)}else{b=new BetaDistribution(d/2,0.5);return b._cdf(1/e,true,c)}if(a<=0)b=!b;if(c)return b?jstat.log1p(-0.5*Math.exp(d)):d-M_LN2;else{d/=2;return b?0.5-d+0.5:d}},_pnt:function(a,b,c){var d=this._dof,e=this._mu,f,g;if(b){f=c?Number.NEGATIVE_INFINITY:0;g=1}else if(c){f=0;g=Number.NEGATIVE_INFINITY}else{f=
1;g=0}var i,h,k,l,n,m,o,p,s,r,x;if(d<=0)return Number.NaN;else if(d==0)return this._pt(a);if(!jstat.isFinite(a))return a<0?f:g;if(a>=0){g=false;l=a;e=e}else{if(e>=40&&(!c||!b))return f;g=true;l=-a;e=-e}if(d>4E5||e*e>2*Math.LN2*-jstat.DBL_MIN_EXP){f=1/(4*d);a=new NormalDistribution(e,Math.sqrt(1+l*l*2*f));return a._cdf(l*(1-f),b!=g,c)}a=a*a;k=d/(a+d);a/=a+d;if(a>0){l=e*e;o=0.5*Math.exp(-0.5*l);if(o==0){console.warn("underflow in _pnt");return f}p=jstat.SQRT_2dPI*o*e;f=0.5-o;if(f<1.0E-7)f=-0.5*jstat.expm1(-0.5*
l);h=0.5;d=0.5*d;k=Math.pow(k,d);i=jstat.LN_SQRT_PI+jstat.lgamma(d)-jstat.lgamma(0.5+d);r=jstat.incompleteBeta(h,d,a);m=2*k*Math.exp(h*Math.log(a)-i);i=d*a;s=i<jstat.DBL_EPSILON?i:1-k;n=i*k;i=o*r+p*s;for(x=1;x<=1E3;x++){h+=1;r-=m;s-=n;m*=a*(h+d-1)/h;n*=a*(h+d-0.5)/(h+0.5);o*=l/(2*x);p*=l/(2*x+1);i+=o*r+p*s;f-=o;if(f<-1.0E-10){console.write("precision error _pnt");break}if(f<=0&&x>1)break;k=2*f*(r-m);if(Math.abs(k)<1.0E-7)break}if(x==1E3)throw"Non-convergence _pnt";}else i=0;a=new NormalDistribution(0,
1);i+=a._cdf(-e,true,false);b=b!=g;i>1-1.0E-10&&b&&console.warn("precision error _pnt");g=jstat.fmin2(i,1);return b?c?Math.log(g):g:c?jstat.log1p(-g):0.5-g+0.5},getDegreesOfFreedom:function(){return this._dof},getNonCentralityParameter:function(){return this._mu},getMean:function(){if(this._dof>1){var a=0.5*Math.log(this._dof/2)+jstat.lgamma((this._dof-1)/2)-jstat.lgamma(this._dof/2);return Math.exp(a)*this._mu}else return Number.NaN},getVariance:function(){return this._dof>2?this._dof*(1+this._mu*
this._mu)/(this._dof-2)-this._mu*this._mu*this._dof/2*Math.pow(Math.exp(jstat.lgamma((this._dof-1)/2)-jstat.lgamma(this._dof/2)),2):Number.NaN}}),Plot=Class.extend({init:function(a,b){this._container="#"+String(a);this._plots=[];this._flotObj=null;this._locked=false;this._options=b!=null?b:{}},getContainer:function(){return this._container},getGraph:function(){return this._flotObj},setData:function(a){this._plots=a},addData:function(a){this._plots.push(a)},render:function(){this._flotObj=$.plot($(this._container),
this._plots,this._options)}}),DistributionPlot=Plot.extend({init:function(a,b,c,d){this._super(a,d);this._showPDF=true;this._showCDF=false;this._pdfValues=[];this._cdfValues=[];this._distribution=b;this._range=c!=null&&Range.validate(c)?c:this._distribution.getRange();this._generateValues();this.render()},_generateValues:function(){this._cdfValues=[];this._pdfValues=[];for(var a=this._range.getPoints(),b=this._distribution.density(this._range),c=this._distribution.cumulativeDensity(this._range),d=
0;d<a.length;d++){this._pdfValues.push([a[d],b[d]]);this._cdfValues.push([a[d],c[d]])}},showPDF:function(){this._showPDF=true;this.render()},hidePDF:function(){this._showPDF=false;this.render()},showCDF:function(){this._showCDF=true;this.render()},hideCDF:function(){this._showCDF=false;this.render()},setDistribution:function(a,b){this._distribution=a;this._range=b!=null?b:a.getRange();this._generateValues();this.render()},getDistribution:function(){return this._distribution},getRange:function(){return this._range},
setRange:function(a){this._range=a;this._generateValues();this.render()},render:function(){if(this._showPDF&&this._showCDF){this.addData([{yaxis:1,data:this._pdfValues,clickable:false,hoverable:false}]);this.addData([{yaxis:2,data:this._cdfValues,clickable:false,hoverable:false}])}else if(this._showPDF)this.addData([{data:this._pdfValues,hoverable:false,clickable:false}]);else this._showCDF&&this.addData([{data:this._cdfValues,hoverable:false,clickable:false}]);this._super()}}),DistributionFactory=
{};
DistributionFactory.build=function(a){if(a.name==null)a=JSON.parse(a);if(a.name!=null)var b=a.name;else throw"Malformed JSON provided to DistributionBuilder "+a;if(b.toLowerCase()=="normal")if(a.parameters.mean!=null&&a.parameters.variance!=null)return new NormalDistribution(a.parameters.mean,a.parameters.variance);else throw"Malformed JSON provided to DistributionBuilder "+a;else if(b.toLowerCase()=="log-normal")if(a.parameters.location!=null&&a.parameters.scale!=null)return new LogNormalDistribution(a.parameters.location,a.parameters.scale);
else throw"Malformed JSON provided to DistributionBuilder "+a;else if(b.toLowerCase()=="beta")if(a.parameters.alpha!=null&&a.parameters.beta!=null)return new BetaDistribution(a.parameters.alpha,a.parameters.beta);else throw"Malformed JSON provided to DistributionBuilder "+a;else if(b.toLowerCase()=="gamma")if(a.parameters.alpha!=null&&a.parameters.beta!=null)return new BetaDistribution(a.parameters.alpha,a.parameters.beta);else throw"Malformed JSON provided to DistributionBuilder "+a;else if(b.toLowerCase()==
"student-t")if(a.parameters.dof!=null&&a.parameters.ncp!=null)return new StudentTDistribution(a.parameters.dof,a.parameters.ncp);else if(a.parameters.degreesOfFreedom!=null)return new StudentTDistribution(a.parameters.dof);else throw"Malformed JSON provided to DistributionBuilder "+a;else throw"Malformed JSON provided to DistributionBuilder "+a;};